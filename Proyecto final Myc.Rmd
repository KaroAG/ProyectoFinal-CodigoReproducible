---
title: "Proyecto Final"
author: "Karol Aguilar"
date: "27/11/2020"
output: html_document
bibliography: library.bib
---

```{r, echo=FALSE}

library(knitr)
opts_knit$set(root.dir = "C:/Users/Karol-PC/Desktop/ProyectoFinal-CodigoReproducible", eval = TRUE, echo = FALSE)

#wd<-setwd("C:/Users/Karol-PC/Desktop/ProyectoFinal-CodigoReproducible")
#getwd()

DatosSW620<- read.csv("CSV_SW620_formato_largo.csv")
DatosSW620


DatosHCT15<- read.csv("CSV_HCT15_formato_largo.csv")
DatosHCT15

DatosHT29<- read.csv("CSV_HT29_formato_largo.csv")
DatosHT29



# Variables

# Tratamiento
#1 = anti-miARNs
#0 = control

# Condición
#1 = todas las células
#0 = células muertas

# Tiempo
#1 = 0 horas 
#2 = 12 horas
#3 = 24 horas
#4 = 36 horas
#5 = 48 horas
#6 = 60 horas
#7 = 72 horas 

```
 
# Validación experimental del fenómeno de compensación de dosis génica del oncogén MYC en líneas celulares de cáncer de colón aneuploide del panel NCI-60.

Según datos de la Oganización  Mundial de la Salud (OMS), el cáncer se colocado como la segunda causa a nivel mundial con un estimado de casi 10 millones de muertes para el 2018 y 18.1 millones de personas diagnósticadas con este padecimiento.

El cáncer define como un grupo o conjunto de enfermedades que se caracteriza por tener una progresión de un estado saludable de las células a un estado maligno con patrones de divisiones anormales y capacidad propagativa hacia otros tejidos [@ManSaiAcon-Chan2018] 

De los "hallmarks" o características más prominentes que presenta el cáncer es la inestabilidad genómica se encuentra en relación estrecha con los cariotipos aneuploides de las células cancerígenas [@Hanahan2011;@Acon-Chan2018]. A pesar de las aneuploidias parecen ser incompatibles con la vida en estado germinal y de desarrollo, en células tumorales les confiere ventajas adaptativas, sin embargo, la célula necesita mediar mecanismos compensatorios para no caer en estados proteo/citotoxicos [@Ben-David2019; @Salmina2019]

Se ha hipotetizado que estos mecanismos regulatorios pueden ir desde regulaciones epigenéticas hasta postr-traduccionales. Es por eso que investigadores se han dado la tarea de investigar como oncogenes específicos median una compensación génica por medio de modelos matemáticos generados con herramientas de biología en sistemas. Uno de estos modelos propone que el gen Myc esta compensado por tres miARNs, y por eso a pesar de que su número de genes es alterado a la alza en más de 70% de los cáncer, sus niveles de proteínas se mantienen estables [@ManSaiAcon-Chan2018]

### Diagrama causal

![](DiagramaCausalMyc.JPG)

## Hipótesis del trabajo 

Este proyecto nace a partir de un desarrollo de un conjunto de científicos utilizando herramientas de biología de sistemas, por lo que primero se plantearon tres hipotesis de grupo que fueron encausando la hipotesis final de tesis

![](HipotesisGrupal.jpg)
![](HipotesisTesis.jpg)
Por lo que el objetivo radica en: determinar si el bloqueo de los miR17, miR19a y miR20a puede alterar la compensación de dosis génica en el gen Myc ocasionando muerte controlada en células aneuploides de cáncer colorrectal

## 1 ¿Cuál es la pregunta específica de investigación?

¿Son los miARNs miR17, miR19a, miR20a, los encargados de mediar la compensación de dósis génica en líneas celulares de cáncer colorectal del panel NCI-60?

## Diseño experimental: Comprobación de la citotoxicidad mediada por los anti-miARNs

Para función de este trabajo, se va a validar nada más el objetivo específico 4 del proyecto de tesis (datos disponibles):

![](Objetivo4.jpg)
### Procedimiento específico seguido para generar los datos para este ejercicio
### ¿De dónde vienen los datos?

Se cultivaron las líneas celulares SW620, HT29 y HCT15 a una concentración de 25 000 células por µL, en cada pocillo de placas de 96 pozos con medio RPMI 1640 completo, y se incubaron aproximadamente 18 horas por la noche a 37°C y 5% CO2. Cumplido el tiempo se retiró el medio y se realizó una tinción con 50 µL de colorante fluorescente azul Hoechst (Thermo Fisher) 1/8000 por 10 minutos para teñir el ADN de los núcleos de las células vivas, posteriormente se removió la solución y se realizó un lavado con PBS (Gibco®). Luego, se añadieron 150 µL del colorante fluorescente SYTOX® GREEN (Thermo Fisher) 1/ 20 000, que se caracteriza por ser no permeable en células vivas, lo que lo hace un buen indicador de células muertas, su pico de emisión se encuentra en 523 nm (Thermo Fisher, 2020).

Simultáneamente, se realizó el procedimiento indicado en Lipofectamine® RNAiMAX Transfection Protocol (Thermo Fisher, 2013) para 96 pocillos, y se agregaron posterior a las tinciones con Hoechst y SYTOX® GREEN 10 µL de concentraciones de 5 µM ,10 µM y 20 µM, tanto de control negativo (ThermoFisher mirVanaTM custom miRNA inhibitor) como de una mezcla de anti-miARN 17, 19a y 20a (ThermoFisher), siguiendo una relación de 1 ADN: 3 Lipofectamina, por duplicado para cada condición. Posteriormente se realizó una cinética en el tiempo por 72 horas en el microscopio automatizado de fluorescencia Cytation 3 (BIOTEK), realizando lecturas cada 12 horas en donde se obtuvieron 4 imágenes que representan distintas zonas de los pocillos, por lo que al final de la cinética se obtienen 8 imágenes por cada condición en 7 tiempos distintos

## Resumen del procedimiento 

![](Procedimiento.jpg)

Importante que las tres líneas celulares utilizadas son de cáncer colorrectar y tiene números distintos para la cantidad de copias del gen Myc (son anueploides para el Myc)

### Procesamiento de los datos y análisis estadístico 

Para los análisis estadísticos se procesaron cada una de las imagenes obtenidas a partir del Cytation, con el programa CellProfiler usando un pipeline que buscaba identificar objetos primarios, corrección de la ilumación y la identificación de objetos secundarios para dos canales de color distintos (DAPI y Sytox) se determinaron cuales eran las células totales vs las células muertas.

AL final se aplicó la prueba t-student (separado para cada línea) de cada uno de los tratamientos en función del tiempo para identificar si habian diferencias significativas en los porcentajes de mortalidad de cada una de las líneas celulares en dependencia de la concetración de anti-miARNs que se estaba utilizando

## DAG
## ¿Cuáles son las variables relevantes y cuál es su relación, conocida y/o hipotética?

En este caso se pueden evaluar dos tipos de de DAG, el primero relacionado con la hipótesis de la tesis, en donde se cree que los tres miARNs van a regular la compensación de dósis génica de Myc y el segundo específico para el objetivo 4: determinar la citotoxicidad de los anti-miRs para cada una de las tres líneas celulares a traves del tiempo

### DAG de la hipótesis de la tesis

```{r}

library(dagitty)
library(ggdag)
library(wesanderson)

CompensacionMyc <- dagify (Myc~miR17,
                           Myc~miR19a,
                           Myc~miR20a,
                           outcome = "Myc")

ggdag(CompensacionMyc, layout = "circle") + theme_dag()

```

### DAG de la comprobación de la citotoxicidad mediada por los anti-miARNs

En este caso debemos de tomar en cuenta, que se utilizaron tres líneas celulares de cáncer colorrectal del panel NCI-60 para el experimento. Estas líneas celulares son aneuploides (tienen una cantidad aberrante de cromosomas en su genoma) para el gen Myc, y poder determinar experimentalmente si la regulación por miARNs es dependiente de la dosis génica, es decir, se espera que aquellas líneas celulas con más copias del gen Myc tengan un porcentaje de mortalidad más alto mediado por los anti-miRs.

Por eso se considera pertinente agregar en el DAG, que la aneuploidia afecta distintivamente cada línea celular, y en consecuencia, si la carga mutacional por aneuploidia es más alta, así va a afectar también la mortalidad de las células. 

```{r}

citotoxicidad <- dagify(Mort~ANEUP,
                        Mort~LC,
                        LC~ANEUP,
                        Mort~AntimiRs,
                        Mort~Tiempo,
                        outcome = "Mort")

ggdag(citotoxicidad, layout = "circle") + theme_dag()

```

## Script y código
## Análisis de los datos

Los datos se van a comparar de manera individual según la concentración de anti-miARNs usada en cada experimento (20uM, 10uM y 5uM)

```{r}

#instalar dplyr
library(dplyr)

SW620 <-DatosSW620 %>% mutate (Linea_celular = 620)
SW620 %>% relocate (Linea_celular)
SW620

HT29 <-DatosHT29 %>% mutate (Linea_celular = 29)
HT29 %>% relocate (Linea_celular)
HT29

#Si agrega la columna nueva pero me sale despues de un monton de Xs que dicen NA, ademas, no se si se puede poner el nombre entero: SW620, o se tiene que hacer igual con un ID bien definido, por ahora voy a usar la parte numerica de cada una de las líneas para guiarme

HCT15 <-DatosHCT15 %>% mutate (Linea_celular = 15)
HCT15 %>% relocate (Linea_celular)
HCT15

#Necesito que la tabla este en el mismo orde para poder hacer el bindrows
#Citotoxicidad_TodasLasLineasCelulares <- bind_rows(HCT15,HT29,SW620)
#write.csv(Citotoxicidad_TodasLasLineasCelulares, File = "DatosProcesadosTotales")

#Es importante tomar en cuenta que se va a buscar normalizar o extrapolar los datos.

#Esta extrapolación se hace asumiendo que al tiempo 1 (0 horas) todos los pocillos están a un 100% (ya sea de células vivas o de células muertas, es decir, para ambas condiciones)

#Primero es necesario generar la tablas entre cada una de las concentraciones

Concentracion20 <- DatosSW620 %>% filter(Concentracion == 20)
Concentracion20

Concentracion10 <- DatosSW620 %>% filter(Concentracion == 10)
Concentracion10

Concentracion5 <- DatosSW620 %>% filter(Concentracion == 5)
Concentracion5

```

#### ¡OJO! esta parte de arriba se podría saltar si inserta la tabla ya de una vez dividida por la concentración

#### Continuando:

```{r}

#Entonces se necesita dividir, para cada tratamiento los valores obtenidos en cada tiempo, entre el tiempo uno, por lo que de nuevo se va a generar una tabla más pequeña para cada pseudoreplica

#if tratamiento = 1

PR1 <- Concentracion20 %>% filter(Pseudoreplica. == 1)
PR1

#¿Se introduce el loop para que divida las pseudoreplicas entre la pseudoreplica en el tiempo uno para normalizar?

#if tratamiento = 1
#Dividir cada uno de los tiempos entre tiempo 1

#if tratamiento = 0
#Dividir cada uno de los tiempos entre tiempo 1

#Se hacen por separado porque la normalización es para tratamiento: con anti-miRs y control negativo 


#Con los datos extrapolados se saca un promedio de todas las pseudoreplicas para cada tiempo

#mean(...)

#¿Se monta una tabla con los promedios?

#Una vez extrapolados se va a proceder a hacer la comparación de cada uno de los porcentajes de muerte en los tratamientos y los controles a través del tiempo con la ayuda de un gráfico


#Para evidenciar si efectivamente si tienen diferencias estadisticas se procede a hacer un t-student para cada tratamiento (anti-miR/control) en función del tiempo


```

## Interpretación breve de los resultados con respecto a la  pregunta de investigación y la hipótesis causal. Máximo un párrafo

## Parte 6: Información de la sesión

```{r InformacionSesion, echo = FALSE, include = TRUE}
sI <- sessionInfo()
sI
```